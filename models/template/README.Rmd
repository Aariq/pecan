A generic template for adding a new model to PEcAn
==========================================================================

Adding a new model to PEcAn in a few easy steps:
1) add modeltype to BETY
2) add a model and PFT to BETY for use with modeltype
3) implement 3 functions as described below
4) execute pecan with new model

There are 3 functions that will need to be implemented, each of these
functions will need to have MODEL be replaced with the actual modeltype as
it is defined in the BETY database.

write.config.MODEL.R:
 This will write the configuratin file as well as the job launcher used by
 PEcAn. There is an example of the job execution script in the template
 folder. The configuration file can also be a template that is found based
 on the revision number of the model. This should use the computed results
 specified in defaults and trait.values to write a configuration file
 based on the PFT and traits found.

met2model.MODEL.R:
 This will convert the standard Met CF file to the model specific file
 format. This will allow PEcAn to create metereological files for the
 specific site and model. This will only be called if no meterological
 data is found for that specific site and model combination.

model2netcdf.MODEL.R
 This will convert the model specific output to NACP Intercomparison
 format. After this function is finished PEcAn will use the generated
 output and not use the model specific outputs. The outputs should be
 named YYYY.nc

--------------------------------------------------------------------------
OLD NOTES
--------------------------------------------------------------------------

**This is a work in progress** 

Please pardon the dust

Packages developed to integrate models (PEcAn.ED, PEcAn.SIPNET, and PEcAn.BIOCRO) should be instructional and useful for reference.

Below are links to Redmine issues that describe the development of PEcAn.SIPNET and PEcAn.BioCro.

## Preliminary Steps

### These issues are the "parent" tasks for the integration of SIPNET and BioCro.

* [SIPNET](https://ebi-forecast.igb.illinois.edu/redmine/issues/552)
* [BioCro](https://ebi-forecast.igb.illinois.edu/redmine/issues/1234)

### Add modeltype to to the BETY Database

## Inputs

### Create model-specific settings.xml template 

See Wiki: github.com/PecanProject/pecan/wiki/

* Example issues
 * [SIPNET](https://ebi-forecast.igb.illinois.edu/redmine/issues/890)
 * [BioCro](https://ebi-forecast.igb.illinois.edu/redmine/issues/1236)

### Model Meteorological Inputs 

Write function to convert netCDF met standard to format required by model 

* Examples
 * [SIPNET](https://ebi-forecast.igb.illinois.edu/redmine/issues/893)
 * [SIPNET](https://ebi-forecast.igb.illinois.edu/redmine/issues/889)
 * [BioCro](https://ebi-forecast.igb.illinois.edu/redmine/issues/1235)

### Parameter Inputs

### Map model parameters to BETY variables, priors, and constants

* Examples
 * [SIPNET](https://ebi-forecast.igb.illinois.edu/redmine/issues/891)
 * [BioCro](https://ebi-forecast.igb.illinois.edu/redmine/issues/1237)

#### Create write.config.MODEL

This function will convert the model parameter values generated by PEcAn and convert them to a format that the model can use.

PEcAn saves these parameter values in a file called `samples.RData`, and an example is provided in the package `PEcAn.utils`. 

The lists `ensemble.samples` and `sa.samples` contain parameter values for the ensemble and sensitivity analyses, respecitvely.

There is one dataframe for each Plant Functional Type (PFT), and these are contained in a list. In this example, the PFT `ebifarm.pavi` represents Switchgrass grown at the Energy Farm in Urbana, IL and modeled by ED2.

```{r}
data(samples, package = "PEcAn.utils")
ls()
names(sa.samples) #the names of one or more Plant Functional Types
head(sa.samples$ebifarm.pavi)
sa.samples
```

### Examples

* [SIPNET](https://ebi-forecast.igb.illinois.edu/redmine/issues/892
* [BioCro](https://ebi-forecast.igb.illinois.edu/redmine/issues/1240

## Outputs

### Write function to convert model output to netCDF standard 

 Examples

* [ED2, SIPNET](https://ebi-forecast.igb.illinois.edu/redmine/issues/1126)

These will ultimately be converted 

### Define Model-specific PFTs and Priors 

* Examples
 * [SIPNET](https://ebi-forecast.igb.illinois.edu/redmine/issues/1130)


```{r}

```

You can also embed plots, for example:

```{r fig.width=7, fig.height=6}
plot(cars)
```

